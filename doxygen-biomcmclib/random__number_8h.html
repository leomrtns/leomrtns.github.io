<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>biomcmc-lib: random_number.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="_biomcmclib-thumbnail.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">biomcmc-lib
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">low level library for phylogenetic analysis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">random_number.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Random number generation, with algorithms from the Gnu Scientific Library (GSL) and motivation from the Scalable Parallel Pseudo Random Number Generators Library (SPRNG).  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;random_number_gen.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for random_number.h:</div>
<div class="dyncontent">
<div class="center"><img src="random__number_8h__incl.png" border="0" usemap="#random__number_8h" alt=""/></div>
<map name="random__number_8h" id="random__number_8h">
<area shape="rect" id="node2" href="random__number__gen_8h_source.html" title="random_number_gen.h" alt="" coords="631,80,786,107"/>
<area shape="rect" id="node3" href="hashtable_8h.html" title="double hashing open&#45;address hash table using strings as key – also has distance matrix, that can be used in alignments and trees " alt="" coords="664,155,753,181"/>
<area shape="rect" id="node4" href="hashfunctions_8h.html" title="Collections of hash functions for 32 and 64 bits, including one&#45;liners, murmurhash, and xxhash. " alt="" coords="651,229,766,256"/>
<area shape="rect" id="node5" href="bipartition_8h.html" title="Unary/binary operators on arbitrarily&#45;sized bitstrings (strings of zeros and ones) like split biparti..." alt="" coords="664,304,753,331"/>
<area shape="rect" id="node6" href="lowlevel_8h.html" title="Lowest level header file. Header file for lowlevel.c. " alt="" coords="669,379,749,405"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="random__number_8h__dep__incl.png" border="0" usemap="#random__number_8hdep" alt=""/></div>
<map name="random__number_8hdep" id="random__number_8hdep">
<area shape="rect" id="node2" href="prob__distribution_8h.html" title="Probability distribution functions and auxiliary mathematical functions from statistical package R..." alt="" coords="492,80,620,107"/>
<area shape="rect" id="node3" href="char__vector_8h.html" title="list of strings (each string is a vector of chars) " alt="" coords="300,155,401,181"/>
<area shape="rect" id="node15" href="topology__randomise_8h.html" title="Creation of random topologies and modification of existing ones through branch swapping. " alt="" coords="324,453,473,480"/>
<area shape="rect" id="node22" href="prob__distribution__aux_8h.html" title="Auxiliary (low level) functions for prob_distribution.c. " alt="" coords="594,155,750,181"/>
<area shape="rect" id="node4" href="nexus__common_8h.html" title="File handling functions for nexus format in general. " alt="" coords="57,304,183,331"/>
<area shape="rect" id="node11" href="empirical__frequency_8h.html" title="Creates a histogram of a vector, ordered by frequency. " alt="" coords="201,229,351,256"/>
<area shape="rect" id="node21" href="char__vector_8c.html" title="vector of strings (species names, leaf names, etc.) " alt="" coords="375,229,476,256"/>
<area shape="rect" id="node5" href="alignment_8h.html" title="File handling functions and calculation of distances for sequence data in nexus format. " alt="" coords="35,379,125,405"/>
<area shape="rect" id="node8" href="read__newick__trees_8h.html" title="Low&#45;level functions for reading newick strings. " alt="" coords="106,453,249,480"/>
<area shape="rect" id="node6" href="kmerhash_8h.html" title="k&#45;mer handling of DNA sequences, with hash transformation " alt="" coords="5,528,96,555"/>
<area shape="rect" id="node7" href="biomcmc_8h.html" title="biomcmc library interface to external programs, specific to super_sptree repo. " alt="" coords="171,677,258,704"/>
<area shape="rect" id="node9" href="newick__space_8h.html" title="Reads a list of trees in newick format and creates vector of topologies. " alt="" coords="121,528,237,555"/>
<area shape="rect" id="node10" href="topology__space_8h.html" title="Reads tree files in nexus format and creates a vector of topologies. " alt="" coords="91,603,215,629"/>
<area shape="rect" id="node12" href="topology__common_8h.html" title="General&#45;purpose topology structures created from nexus_tree_struct (and low&#45;level functions) ..." alt="" coords="207,304,345,331"/>
<area shape="rect" id="node20" href="empirical__frequency_8c.html" title="histogram of vectors, ordered by frequency. Also calculates MAP (modal) values. " alt="" coords="369,304,519,331"/>
<area shape="rect" id="node13" href="topology__distance_8h.html" title="branch length operations on topologies, including patristic distances " alt="" coords="213,379,352,405"/>
<area shape="rect" id="node14" href="parsimony_8h.html" title="binary and multistate parsimony matrices, together with bipartition extraction for MRP ..." alt="" coords="240,603,333,629"/>
<area shape="rect" id="node16" href="upgma_8h.html" title="UPGMA and bioNJ from (onedimensional representation of) distance matrices. " alt="" coords="363,528,435,555"/>
<area shape="rect" id="node17" href="genetree_8h.html" title="gene tree and species tree structures, for reconciliation etc. This is the high&#45;level file with globa..." alt="" coords="357,603,440,629"/>
<area shape="rect" id="node18" href="reconciliation_8h.html" title="low&#45;level file for gene tree and species tree reconciliation. This file is hidden from user and conta..." alt="" coords="344,677,453,704"/>
<area shape="rect" id="node19" href="splitset__distances_8h.html" title="Low&#45;level functions that use only the split bipartitions of topologies – treating them as unrooted u..." alt="" coords="329,752,468,779"/>
</map>
</div>
</div>
<p><a href="random__number_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbiomcmc__rng__struct.html">biomcmc_rng_struct</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Random number structure (combined Tausworthe algorithm)  <a href="structbiomcmc__rng__struct.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a7ab6b2fbca811d4db16dafffc88bd902"><td class="memItemLeft" align="right" valign="top"><a id="a7ab6b2fbca811d4db16dafffc88bd902"></a>
typedef struct <a class="el" href="structbiomcmc__rng__struct.html">biomcmc_rng_struct</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>biomcmc_rng</b></td></tr>
<tr class="separator:a7ab6b2fbca811d4db16dafffc88bd902"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9d5045f3aa04de0b94b321aea043dada"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="random__number_8h.html#a9d5045f3aa04de0b94b321aea043dada">biomcmc_random_number_init</a> (unsigned long long int seed)</td></tr>
<tr class="memdesc:a9d5045f3aa04de0b94b321aea043dada"><td class="mdescLeft">&#160;</td><td class="mdescRight">High-level setup of a simple random number generator and initialization with a seed (not to be mixed with other low-level functions that update the seed or allocate memory).  <a href="#a9d5045f3aa04de0b94b321aea043dada">More...</a><br /></td></tr>
<tr class="separator:a9d5045f3aa04de0b94b321aea043dada"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace9dead018c13a4d682a3b1cc5defc76"><td class="memItemLeft" align="right" valign="top"><a id="ace9dead018c13a4d682a3b1cc5defc76"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="random__number_8h.html#ace9dead018c13a4d682a3b1cc5defc76">biomcmc_random_number_finalize</a> (void)</td></tr>
<tr class="memdesc:ace9dead018c13a4d682a3b1cc5defc76"><td class="mdescLeft">&#160;</td><td class="mdescRight">High-level finalization (memory release etc.) of the random number environment. <br /></td></tr>
<tr class="separator:ace9dead018c13a4d682a3b1cc5defc76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeea4bf21dbe5cbfc7d545e8435b6855"><td class="memItemLeft" align="right" valign="top"><a id="adeea4bf21dbe5cbfc7d545e8435b6855"></a>
<a class="el" href="structbiomcmc__rng__struct.html">biomcmc_rng</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="random__number_8h.html#adeea4bf21dbe5cbfc7d545e8435b6855">new_biomcmc_rng</a> (unsigned long long int seed, int stream_number)</td></tr>
<tr class="memdesc:adeea4bf21dbe5cbfc7d545e8435b6855"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory for new (Tausworthe + MT19937) generator from a pool of streams. <br /></td></tr>
<tr class="separator:adeea4bf21dbe5cbfc7d545e8435b6855"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7556fab9f7482092b8106b1ab54a5b1c"><td class="memItemLeft" align="right" valign="top"><a id="a7556fab9f7482092b8106b1ab54a5b1c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="random__number_8h.html#a7556fab9f7482092b8106b1ab54a5b1c">del_biomcmc_rng</a> (<a class="el" href="structbiomcmc__rng__struct.html">biomcmc_rng</a> r)</td></tr>
<tr class="memdesc:a7556fab9f7482092b8106b1ab54a5b1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release memory occupied by biomcmc_rng:: <br /></td></tr>
<tr class="separator:a7556fab9f7482092b8106b1ab54a5b1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac2831fa8bcae85637cce1f0c4c5d562"><td class="memItemLeft" align="right" valign="top"><a id="aac2831fa8bcae85637cce1f0c4c5d562"></a>
unsigned long long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="random__number_8h.html#aac2831fa8bcae85637cce1f0c4c5d562">biomcmc_rng_get_initial_seed</a> (void)</td></tr>
<tr class="memdesc:aac2831fa8bcae85637cce1f0c4c5d562"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create initial seed based on time, combining time in microseconds and seconds (user-controled seed is not uint64_t) <br /></td></tr>
<tr class="separator:aac2831fa8bcae85637cce1f0c4c5d562"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f7d8f4c1e5de930c88330b52d17538e"><td class="memItemLeft" align="right" valign="top"><a id="a8f7d8f4c1e5de930c88330b52d17538e"></a>
<a class="el" href="structbiomcmc__rng__struct.html">biomcmc_rng</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="random__number_8h.html#a8f7d8f4c1e5de930c88330b52d17538e">new_biomcmc_rng_from_seed</a> (unsigned long long int seed, int stream_number)</td></tr>
<tr class="memdesc:a8f7d8f4c1e5de930c88330b52d17538e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a vector of seeds (based on initial one), create and initialize stream with an element of this vector. <br /></td></tr>
<tr class="separator:a8f7d8f4c1e5de930c88330b52d17538e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b5a367c8a609ab0292430306ae7d93a"><td class="memItemLeft" align="right" valign="top"><a id="a6b5a367c8a609ab0292430306ae7d93a"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="random__number_8h.html#a6b5a367c8a609ab0292430306ae7d93a">biomcmc_rng_snorm32</a> (void)</td></tr>
<tr class="memdesc:a6b5a367c8a609ab0292430306ae7d93a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a random number from a Standard Normal distribution N(0,1) - <a class="el" href="prob__distribution_8h.html" title="Probability distribution functions and auxiliary mathematical functions from statistical package R...">prob_distribution.h</a> has general case. <br /></td></tr>
<tr class="separator:a6b5a367c8a609ab0292430306ae7d93a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad33735d55fad58caeb2bf7b5b56cdc44"><td class="memItemLeft" align="right" valign="top"><a id="ad33735d55fad58caeb2bf7b5b56cdc44"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="random__number_8h.html#ad33735d55fad58caeb2bf7b5b56cdc44">biomcmc_rng_snorm</a> (void)</td></tr>
<tr class="memdesc:ad33735d55fad58caeb2bf7b5b56cdc44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a random number from a Standard Normal distribution with maximum (52 bits) integer precision. <br /></td></tr>
<tr class="separator:ad33735d55fad58caeb2bf7b5b56cdc44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0dfcb9f5e5f636d9ee87756c3e04cf2"><td class="memItemLeft" align="right" valign="top"><a id="aa0dfcb9f5e5f636d9ee87756c3e04cf2"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="random__number_8h.html#aa0dfcb9f5e5f636d9ee87756c3e04cf2">biomcmc_rng_unif</a> (void)</td></tr>
<tr class="memdesc:aa0dfcb9f5e5f636d9ee87756c3e04cf2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a random number between 0 and 1 (including 1) with precision <img class="formulaInl" alt="$\approx 10^{-15}$" src="form_10.png"/> (52 bits). <br /></td></tr>
<tr class="separator:aa0dfcb9f5e5f636d9ee87756c3e04cf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c1442aeea748b656e9efb98e5d725ab"><td class="memItemLeft" align="right" valign="top"><a id="a1c1442aeea748b656e9efb98e5d725ab"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="random__number_8h.html#a1c1442aeea748b656e9efb98e5d725ab">biomcmc_rng_unif_pos</a> (void)</td></tr>
<tr class="memdesc:a1c1442aeea748b656e9efb98e5d725ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a positive random number between 0 and 1 (excluding 0 and including 1) (52 bits). <br /></td></tr>
<tr class="separator:a1c1442aeea748b656e9efb98e5d725ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26cc568dce9194edff7278e9721251ef"><td class="memItemLeft" align="right" valign="top"><a id="a26cc568dce9194edff7278e9721251ef"></a>
uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="random__number_8h.html#a26cc568dce9194edff7278e9721251ef">biomcmc_rng_unif_int64</a> (uint64_t n)</td></tr>
<tr class="memdesc:a26cc568dce9194edff7278e9721251ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a long integer (64 bits) random number between 0 and n (excluding n), with <img class="formulaInl" alt="$n &lt; 10^{15}$" src="form_11.png"/>. <br /></td></tr>
<tr class="separator:a26cc568dce9194edff7278e9721251ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46f7b9363d5cb324e8cc18d5d2b6016d"><td class="memItemLeft" align="right" valign="top"><a id="a46f7b9363d5cb324e8cc18d5d2b6016d"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="random__number_8h.html#a46f7b9363d5cb324e8cc18d5d2b6016d">biomcmc_rng_unif32</a> (void)</td></tr>
<tr class="memdesc:a46f7b9363d5cb324e8cc18d5d2b6016d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a random number between 0 and 1 (including 1) with precision <img class="formulaInl" alt="$\approx 10^{-9}$" src="form_12.png"/> (32 int bits). <br /></td></tr>
<tr class="separator:a46f7b9363d5cb324e8cc18d5d2b6016d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2307df858407307b7f3a0970dbbef84"><td class="memItemLeft" align="right" valign="top"><a id="aa2307df858407307b7f3a0970dbbef84"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="random__number_8h.html#aa2307df858407307b7f3a0970dbbef84">biomcmc_rng_unif_pos32</a> (void)</td></tr>
<tr class="memdesc:aa2307df858407307b7f3a0970dbbef84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a positive random number between 0 and 1 (including 1) (32 int bits). <br /></td></tr>
<tr class="separator:aa2307df858407307b7f3a0970dbbef84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a366c181844faba3c00096cc755f3d762"><td class="memItemLeft" align="right" valign="top"><a id="a366c181844faba3c00096cc755f3d762"></a>
uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="random__number_8h.html#a366c181844faba3c00096cc755f3d762">biomcmc_rng_unif_int</a> (uint32_t n)</td></tr>
<tr class="memdesc:a366c181844faba3c00096cc755f3d762"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns an integer (32 bits) random number between 0 and n (excluding n), provided <img class="formulaInl" alt="$n &lt; 4 10^9$" src="form_13.png"/> approx. <br /></td></tr>
<tr class="separator:a366c181844faba3c00096cc755f3d762"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f093666e5bc35f2639c5a6d7951a96b"><td class="memItemLeft" align="right" valign="top"><a id="a2f093666e5bc35f2639c5a6d7951a96b"></a>
uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="random__number_8h.html#a2f093666e5bc35f2639c5a6d7951a96b">biomcmc_rng_get</a> (void)</td></tr>
<tr class="memdesc:a2f093666e5bc35f2639c5a6d7951a96b"><td class="mdescLeft">&#160;</td><td class="mdescRight">new value with 64 random bits <br /></td></tr>
<tr class="separator:a2f093666e5bc35f2639c5a6d7951a96b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af97680c1cf83fb81cfe52dc56ab37275"><td class="memItemLeft" align="right" valign="top"><a id="af97680c1cf83fb81cfe52dc56ab37275"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="random__number_8h.html#af97680c1cf83fb81cfe52dc56ab37275">biomcmc_rng_get_52</a> (void)</td></tr>
<tr class="memdesc:af97680c1cf83fb81cfe52dc56ab37275"><td class="mdescLeft">&#160;</td><td class="mdescRight">new value with 52 random bits as a double precision float <br /></td></tr>
<tr class="separator:af97680c1cf83fb81cfe52dc56ab37275"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83059b4f006f03468c36a15acb55d773"><td class="memItemLeft" align="right" valign="top"><a id="a83059b4f006f03468c36a15acb55d773"></a>
uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="random__number_8h.html#a83059b4f006f03468c36a15acb55d773">biomcmc_rng_get_32</a> (void)</td></tr>
<tr class="memdesc:a83059b4f006f03468c36a15acb55d773"><td class="mdescLeft">&#160;</td><td class="mdescRight">new value with 32 random bits <br /></td></tr>
<tr class="separator:a83059b4f006f03468c36a15acb55d773"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62a8cc19475bef4fe1477ba42e14a821"><td class="memItemLeft" align="right" valign="top"><a id="a62a8cc19475bef4fe1477ba42e14a821"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="random__number_8h.html#a62a8cc19475bef4fe1477ba42e14a821">biomcmc_get_time</a> (int *time)</td></tr>
<tr class="memdesc:a62a8cc19475bef4fe1477ba42e14a821"><td class="mdescLeft">&#160;</td><td class="mdescRight">get current time with maximum precision and soter in vector time[2] <br /></td></tr>
<tr class="separator:a62a8cc19475bef4fe1477ba42e14a821"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3444330ddcef251cc035a2d5d28cfb46"><td class="memItemLeft" align="right" valign="top"><a id="a3444330ddcef251cc035a2d5d28cfb46"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="random__number_8h.html#a3444330ddcef251cc035a2d5d28cfb46">biomcmc_elapsed_time</a> (int *now, int *past)</td></tr>
<tr class="memdesc:a3444330ddcef251cc035a2d5d28cfb46"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the floating-point time in seconds elapsed between past[2] and now[2] <br /></td></tr>
<tr class="separator:a3444330ddcef251cc035a2d5d28cfb46"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa6d5847992f74a215315ce3bb63dfd5f"><td class="memItemLeft" align="right" valign="top"><a id="aa6d5847992f74a215315ce3bb63dfd5f"></a>
<a class="el" href="structbiomcmc__rng__struct.html">biomcmc_rng</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="random__number_8h.html#aa6d5847992f74a215315ce3bb63dfd5f">biomcmc_random_number</a></td></tr>
<tr class="memdesc:aa6d5847992f74a215315ce3bb63dfd5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">pointer to pseudo-random number generator (should point to real stream, even when there are several) <br /></td></tr>
<tr class="separator:aa6d5847992f74a215315ce3bb63dfd5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Random number generation, with algorithms from the Gnu Scientific Library (GSL) and motivation from the Scalable Parallel Pseudo Random Number Generators Library (SPRNG). </p>
<p>There are two ways of setting up the pseudo-random number generation: a high-level approach where we simply call one function before start using the generator and another after we finished using it, and a lower-level approach where we must allocate, seed and free the streams by hand. Both approaches are completely incompatible, and there is no check to avoid this mistake so the programmer should use the first, high-level approach unless he understand well the algorithms. The high-level approach is useful when one stream is enough (for instance, a serial program). In this case we use a (modified) maximally-equidistributed combined Linear Feedback Shift Register (LFSR, or Tausworthe) pseudo-random number generator (PRNG) whose seed is based on time of day.</p>
<p>The low level approach is useful if one needs several uncorrelated streams - for example a parallel program where each node must have its own stream of pseudo-random numbers and a common stream shared by all nodes. For this we implemented a modified <a href="http://www.mcs.anl.gov/~itf/dbpp/text/node119.html">random tree method</a> where a lagged-Fibonacci generator (two-tap Generalised Feedback Shift Register - GFSR4) PRNG is used to generate the seeds for the (modified) Tausworthe streams. The seed for this GFSR4 generator is given by the time of day and should be set only once by the program, given its low randomness. The GFSR4 uses a vector of size <img class="formulaInl" alt="$2^14$" src="form_5.png"/> which is initialized by an (quick-and-dirty) xorshift randomization of the seed, which makes it sensitive to the choice of this seed. I included a <a href="http://ianbullard.squarespace.com/journal/2009/4/28/why-you-should-never-use-rand.html">gamerand fast randomization</a> over each element of the vector, modified for 64 bits (the algorithm is too simple to require a license and I've seen public domain versions of it; the original disclaimer is GPL-like). A more robust alternative <b>not implemented here</b> would be to use a better PRNG to feed the initial vector of the GFSR4 generator. As noticed by <a href="http://www.springerlink.com/content/ek34q1jwla5b6438/">CJK Tan and JAR Blais (HPCN 2000, LNCS 1823, 127-135)</a> another random tree method could be constructed with parallel GFSR4 streams where the initial states are created by an PRNG - equivalent to our seed generator, but providing not only the seed but all <img class="formulaInl" alt="$2^{14}$" src="form_6.png"/> elements to each stream. To ensure independence of streams - since different seeds are just different points of the same stream - we implemented all 150 parameter sets provided by <a href="http://www.iro.umontreal.ca/~lecuyer/myftp/papers/tausme2.ps">L'ecuyer (Maths Comput 1999, pp.261)</a>for the Tausworthe generators. So we have at least 150 independent streams, with periods between <img class="formulaInl" alt="$10^{14}$" src="form_7.png"/> and <img class="formulaInl" alt="$10^{35}$" src="form_8.png"/> - if I understood correctly the interpretation of the number of non-zero solutions of the polynomials <img class="formulaInl" alt="$N_1$" src="form_9.png"/>.</p>
<p>Our modification to the original Tausworthe (LFSR) algorithms is to combine it with the <a href="http://wwwmaths.anu.edu.au/~brent/random.html">generalized Marsaglias's xorshift PRNG called xorgens</a>, developed by Richard Brent and available under a GPL license. So the LFSR has one extra component from this independent xorshift (combined through a XOR). The seed for the xorshift is the same as for the Tausworthe.</p>
<p>All streams are of 64 bits (dependent on a "long long int" having 64 bits) but 32 bits or even 16 bits are available through wrapper functions. If your system does not provide 64 bit integers use the unwrapped versions instead. When working with more than one stream at the same time - by the same node, using the example of a parallel program - we must update by hand the variable pointed to by the global variable ::random_number to indicate which stream should be used.</p>
<p>Some original comments from the GSL can be found on "doc/random_number_generation.txt" </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a9d5045f3aa04de0b94b321aea043dada"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d5045f3aa04de0b94b321aea043dada">&#9670;&nbsp;</a></span>biomcmc_random_number_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void biomcmc_random_number_init </td>
          <td>(</td>
          <td class="paramtype">unsigned long long int&#160;</td>
          <td class="paramname"><em>seed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>High-level setup of a simple random number generator and initialization with a seed (not to be mixed with other low-level functions that update the seed or allocate memory). </p>
<p>The seed may be provided by calling function (mostly for debug) if not zero otherwise it is based on present time of day, and uses the Tausworthe pseudo-random number generator. The Tausworthe generator we use has a period of (at least?) <img class="formulaInl" alt="$10^{35}$" src="form_8.png"/>. This function allocates memory to global variable ::random_number directly </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
